<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Loading + WiFi + IP Confirm + Upload + Server Location</title>
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body, html {
    margin: 0; padding: 0; height: 100%;
    background-color: #000;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #39ff14;
    overflow: hidden;
    user-select: none;
  }

  #app {
    width: 100vw;
    height: 100vh;
    position: relative;
  }

  .page {
    width: 100%;
    height: 100%;
    position: absolute;
    background: #000;
    top: 0;
    left: 0;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: #39ff14;
    text-align: center;
  }
  .page.active {
    display: flex;
  }

  /* COMMON STYLES */
  h1, h2, h3 {
    margin: 0.2em 0 0.4em;
    font-weight: 900;
    letter-spacing: 0.1em;
    text-shadow:
      0 0 10px #39ff14,
      0 0 20px #39ff14;
  }

  h2 {
    font-size: 2rem;
  }
  h3 {
    font-size: 1.2rem;
    font-weight: 700;
  }

  p {
    margin: 0.4em 0 0;
    font-weight: 600;
    font-size: 1.1rem;
    letter-spacing: 0.05em;
  }

  button {
    background-color: transparent;
    border: 2px solid #39ff14;
    color: #39ff14;
    font-weight: 700;
    font-size: 1.1rem;
    padding: 0.4em 1.2em;
    margin: 1em 0.5em 0 0.5em;
    border-radius: 12px;
    cursor: pointer;
    transition: background-color 0.3s ease, color 0.3s ease;
    text-shadow: 0 0 6px #39ff14;
  }
  button:hover {
    background-color: #39ff14;
    color: #000;
    box-shadow: 0 0 14px #39ff14;
  }
  button:active {
    transform: scale(0.95);
  }

  /* LOADING CIRCLE */
  .loading-circle {
    width: 160px;
    height: 160px;
    margin-bottom: 1em;
  }
  svg circle.bg {
    fill: none;
    stroke: #0a2900;
    stroke-width: 12;
  }
  svg circle.fg {
    fill: none;
    stroke: #39ff14;
    stroke-width: 12;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.3s ease;
    filter:
      drop-shadow(0 0 6px #39ff14);
  }

  /* WIFI ICON */
  .wifi-icon {
    width: 90px;
    height: 90px;
    margin-bottom: 1em;
  }
  .wifi-path {
    fill: none;
    stroke: #39ff14;
    stroke-width: 6;
    filter: drop-shadow(0 0 8px #39ff14);
  }
  .wifi-dot {
    fill: #39ff14;
    filter: drop-shadow(0 0 12px #39ff14);
  }

  /* IP CONFIRM SCREEN */
  .ip-display {
    font-family: monospace;
    font-size: 1.8rem;
    font-weight: 900;
    margin: 0.4em 0 0.2em;
    letter-spacing: 0.12em;
    text-shadow:
      0 0 8px #39ff14;
  }
  .speed-display {
    font-size: 1.3rem;
    font-weight: 700;
    margin-bottom: 1.2em;
    letter-spacing: 0.07em;
  }
  .confirm-text {
    font-size: 1.4rem;
    font-weight: 800;
    margin-bottom: 1.2em;
  }

  /* UPLOADING SCREEN */
  .uploading-text {
    font-size: 1.8rem;
    font-weight: 900;
    margin-bottom: 1.4em;
    letter-spacing: 0.15em;
  }
  .uploading-dots {
    font-size: 2.2rem;
    font-weight: 900;
    color: #39ff14;
    animation: pulseDots 2s infinite;
  }
  @keyframes pulseDots {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  /* SUCCESS SCREEN */
  .success-title {
    font-size: 3rem;
    font-weight: 900;
    margin-bottom: 0.2em;
  }
  .success-subtitle {
    font-size: 1.6rem;
    font-weight: 700;
    margin-bottom: 1.4em;
  }
  .server-city {
    font-size: 1.9rem;
    font-weight: 900;
    margin-top: 1.2em;
    letter-spacing: 0.1em;
    text-shadow:
      0 0 10px #39ff14,
      0 0 20px #39ff14;
  }

  /* WORLD MAP SVG */
  .world-map {
    width: 700px;
    max-width: 90vw;
    height: auto;
    filter: drop-shadow(0 0 10px #39ff14);
  }
  .map-path {
    fill: #0a2900;
    stroke: #39ff14;
    stroke-width: 0.6;
    opacity: 0.85;
  }
  .map-highlight {
    fill: #39ff14;
    filter: drop-shadow(0 0 12px #39ff14);
    opacity: 0.8;
  }
  .city-label {
    font-family: monospace;
    font-size: 0.9rem;
    font-weight: 700;
    fill: #39ff14;
    text-shadow: 0 0 6px #39ff14;
    cursor: default;
    user-select: none;
  }
</style>
</head>
<body>
<div id="app">

  <!-- PAGE 1: LOADING -->
  <section id="page-loading" class="page active" aria-label="Loading screen">
    <svg class="loading-circle" viewBox="0 0 160 160" role="img" aria-labelledby="loadingTitle">
      <title id="loadingTitle">Loading progress</title>
      <circle class="bg" cx="80" cy="80" r="70"></circle>
      <circle class="fg" cx="80" cy="80" r="70" stroke-dasharray="439.82" stroke-dashoffset="439.82"></circle>
      <text x="80" y="95" text-anchor="middle" fill="#39ff14" font-size="40" font-weight="900" style="text-shadow:0 0 8px #39ff14;" id="loading-percent">0%</text>
    </svg>
    <h2>Loading your connection...</h2>
  </section>

  <!-- PAGE 2: WIFI CONNECTED -->
  <section id="page-wifi" class="page" aria-label="WiFi connected screen" role="region" aria-live="polite">
    <svg class="wifi-icon" viewBox="0 0 64 64" role="img" aria-labelledby="wifiTitle">
      <title id="wifiTitle">WiFi Connected Icon</title>
      <path class="wifi-path" d="M2 38a30 30 0 0 1 60 0" />
      <path class="wifi-path" d="M10 46a22 22 0 0 1 44 0" />
      <path class="wifi-path" d="M18 54a14 14 0 0 1 28 0" />
      <circle class="wifi-dot" cx="32" cy="60" r="4" />
    </svg>
    <h1>WiFi Connected</h1>
    <p>Your internet connection is active and stable.</p>
  </section>

  <!-- PAGE 3: IP & SPEED CONFIRM -->
  <section id="page-ipconfirm" class="page" aria-label="IP and speed confirmation screen" role="region" aria-live="polite">
    <h2>Your IP Address:</h2>
    <div class="ip-display" id="ip-address">0.0.0.0</div>
    <div class="speed-display" id="speed-display">Download: -- Mbps | Upload: -- Mbps</div>
    <div class="confirm-text">Is this information correct?</div>
    <div>
      <button id="btn-yes">Yes</button>
      <button id="btn-no">No</button>
    </div>
  </section>

  <!-- PAGE 4: UPLOADING TO SERVERS -->
  <section id="page-uploading" class="page" aria-label="Uploading to servers screen" role="region" aria-live="polite">
    <h2 class="uploading-text">Uploading to servers<span class="uploading-dots">...</span></h2>
    <svg class="loading-circle" viewBox="0 0 160 160" role="img" aria-labelledby="uploadLoadingTitle">
      <title id="uploadLoadingTitle">Uploading progress</title>
      <circle class="bg" cx="80" cy="80" r="70"></circle>
      <circle class="fg" cx="80" cy="80" r="70" stroke-dasharray="439.82" stroke-dashoffset="439.82"></circle>
      <text x="80" y="95" text-anchor="middle" fill="#39ff14" font-size="40" font-weight="900" style="text-shadow:0 0 8px #39ff14;" id="upload-percent">0%</text>
    </svg>
  </section>

  <!-- PAGE 5: UPLOAD SUCCESS + SERVER LOCATION -->
  <section id="page-success" class="page" aria-label="Upload successful screen with server location" role="region" aria-live="polite" style="flex-direction: column;">
    <h1 class="success-title">Upload Successful</h1>
    <h3 class="success-subtitle">You are now connected to the server:</h3>
    <div id="server-city" class="server-city" aria-live="polite">Loading city...</div>
    <!-- World Map SVG -->
    <svg class="world-map" viewBox="0 0 960 500" role="img" aria-labelledby="worldMapTitle">
      <title id="worldMapTitle">World Map with Server Locations</title>
      <rect width="960" height="500" fill="#000" />
      <g>
        <!-- Simplified continents shape, dark green with green outline -->
        <path class="map-path" d="M96,350 L130,320 L150,280 L190,250 L220,220 L240,180 L270,150 L310,130 L340,130 L380,140 L400,170 L420,210 L440,260 L460,310 L480,350 L500,390 L520,430 L540,460 L580,460 L600,440 L620,400 L640,360 L660,310 L680,260 L700,220 L720,180 L740,150 L760,120 L780,100 L800,90 L820,110 L840,140 L860,180 L880,230 L900,280 L920,330 L940,380 L960,420 L960,500 L0,500 L0,420 L20,370 L50,350 Z" />
      </g>

      <!-- Server locations circles & labels -->
      <g id="server-locations">
        <!-- The circles and city labels will be inserted by JS -->
      </g>
    </svg>
  </section>

</div>

<script>
(() => {
  // Utility functions
  function lerp(start, end, t) {
    return start + (end - start) * t;
  }
  // Circumference for circle r=70
  const circumference = 2 * Math.PI * 70;

  // Pages
  const pages = {
    loading: document.getElementById('page-loading'),
    wifi: document.getElementById('page-wifi'),
    ipConfirm: document.getElementById('page-ipconfirm'),
    uploading: document.getElementById('page-uploading'),
    success: document.getElementById('page-success'),
  };

  // Loading page elements
  const loadingCircle = pages.loading.querySelector('circle.fg');
  const loadingPercentText = document.getElementById('loading-percent');

  // Uploading page elements
  const uploadingCircle = pages.uploading.querySelector('circle.fg');
  const uploadPercentText = document.getElementById('upload-percent');

  // IP confirm elements
  const ipAddressEl = document.getElementById('ip-address');
  const speedDisplayEl = document.getElementById('speed-display');
  const btnYes = document.getElementById('btn-yes');
  const btnNo = document.getElementById('btn-no');

  // Success elements
  const serverCityEl = document.getElementById('server-city');
  const serverLocationsGroup = document.getElementById('server-locations');

  // Store generated IP and speed
  let currentIP = "";
  let currentDownload = 0;
  let currentUpload = 0;

  // Server cities (40 total, 7 US popular + others worldwide)
  const servers = [
    { city: "New York, USA", coords: [300, 220] },
    { city: "Los Angeles, USA", coords: [150, 320] },
    { city: "Chicago, USA", coords: [270, 250] },
    { city: "Houston, USA", coords: [280, 310] },
    { city: "Miami, USA", coords: [350, 370] },
    { city: "Seattle, USA", coords: [180, 190] },
    { city: "San Francisco, USA", coords: [140, 270] },

    { city: "London, UK", coords: [600, 140] },
    { city: "Paris, France", coords: [640, 170] },
    { city: "Berlin, Germany", coords: [670, 130] },
    { city: "Madrid, Spain", coords: [630, 220] },
    { city: "Rome, Italy", coords: [680, 210] },
    { city: "Amsterdam, Netherlands", coords: [650, 150] },
    { city: "Dublin, Ireland", coords: [590, 120] },

    { city: "Tokyo, Japan", coords: [860, 220] },
    { city: "Seoul, South Korea", coords: [830, 230] },
    { city: "Beijing, China", coords: [790, 190] },
    { city: "Shanghai, China", coords: [780, 200] },
    { city: "Bangkok, Thailand", coords: [820, 270] },
    { city: "Mumbai, India", coords: [740, 290] },
    { city: "Singapore", coords: [810, 300] },

    { city: "Sydney, Australia", coords: [900, 430] },
    { city: "Melbourne, Australia", coords: [880, 460] },
    { city: "Brisbane, Australia", coords: [900, 400] },

    { city: "Moscow, Russia", coords: [700, 110] },
    { city: "Istanbul, Turkey", coords: [660, 190] },
    { city: "Cairo, Egypt", coords: [680, 270] },
    { city: "Johannesburg, South Africa", coords: [690, 410] },

    { city: "Sao Paulo, Brazil", coords: [450, 390] },
    { city: "Buenos Aires, Argentina", coords: [480, 420] },
    { city: "Lima, Peru", coords: [410, 430] },
    { city: "Bogota, Colombia", coords: [430, 390] },

    { city: "Toronto, Canada", coords: [320, 210] },
    { city: "Vancouver, Canada", coords: [200, 200] },
    { city: "Montreal, Canada", coords: [340, 210] },

    { city: "Dubai, UAE", coords: [710, 260] },
    { city: "Mexico City, Mexico", coords: [360, 340] },
    { city: "Hong Kong", coords: [820, 220] },
  ];

  // Show page helper
  function showPage(pageName) {
    Object.values(pages).forEach(p => p.classList.remove('active'));
    pages[pageName].classList.add('active');
  }

  // Animate circle progress 0 to 100 over duration (ms)
  function animateProgress(circleEl, textEl, duration, onComplete) {
    const start = performance.now();
    function animate(time) {
      let elapsed = time -
